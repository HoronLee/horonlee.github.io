import{_ as c}from"./ValaxyMain.vue_vue_type_style_index_0_lang.BKY0BFev.js";import"./chunks/@vueuse/motion.C1YF0VrX.js";import{d as p,u as b,a as g}from"./chunks/vue-router.B0lpXBWQ.js";import{X as m,b3 as F,b_ as e,be as a,_ as i,a5 as t,bB as v,b5 as y}from"./framework.tSB2Odh-.js";import"./app.CfWrNu88.js";import"./chunks/dayjs.BmWuu2Zz.js";import"./chunks/vue-i18n.CP2UHYEb.js";import"./chunks/pinia.BF0-M7Fk.js";import"./chunks/nprogress.YXB5kar1.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.DoC94HOc.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.CBF25nPr.js";import"./post.TKccRjPH.js";const f=p("/posts/KubeVirt-Getting-Start",async l=>JSON.parse('{"title":"KubeVirt入门","description":"","frontmatter":{"layout":"post","title":"KubeVirt入门","date":"2024-05-30 16:22:50","tags":["Linux","Kubernetes","云计算","KubeVirt"],"categories":["服务器运维","云计算","虚拟化"],"cover":"https://tse3-mm.cn.bing.net/th/id/OIP-C.B4Rc1aupXxDrxKPfYpOsMQHaDP?rs=1&pid=ImgDetMain","password":null,"hide":null},"headers":[],"relativePath":"pages/posts/KubeVirt-Getting-Start.md","lastUpdated":1767692976000}'),{lazy:(l,r)=>l.name===r.name}),A={__name:"KubeVirt-Getting-Start",setup(l,{expose:r}){const{data:h}=f(),k=b(),u=g(),n=Object.assign(u.meta.frontmatter||{},h.value?.frontmatter||{});return k.currentRoute.value.data=h.value,y("valaxy:frontmatter",n),globalThis.$frontmatter=n,r({frontmatter:{layout:"post",title:"KubeVirt入门",date:"2024-05-30 16:22:50",tags:["Linux","Kubernetes","云计算","KubeVirt"],categories:["服务器运维","云计算","虚拟化"],cover:"https://tse3-mm.cn.bing.net/th/id/OIP-C.B4Rc1aupXxDrxKPfYpOsMQHaDP?rs=1&pid=ImgDetMain",password:null,hide:null}}),(s,o)=>{const d=c;return F(),m(d,{frontmatter:v(n)},{"main-content-md":e(()=>[...o[0]||(o[0]=[i("h1",{id:"什么是-kubevirt",tabindex:"-1"},[t("什么是 KubeVirt？ "),i("a",{class:"header-anchor",href:"#什么是-kubevirt","aria-label":'Permalink to "什么是 KubeVirt？"'},"​")],-1),i("p",null,"​ KubeVirt 是一个开源项目，它使得虚拟机可以像容器一样被 Kubernetes 部署，消费和管理。它提供了一个统一的平台，让用户可以根据不同的需求，使用容器或者虚拟机来构建云原生应用。KubeVirt 项目于 2016 年启动，由 Red Hat, IBM, Google, Intel, SUSE 等多家公司和组织共同推动和贡献。经过 7 年的不懈努力，KubeVirt 于 2023 年 7 月发布了 v1.0.0 版本，标志着它已经达到了生产就绪的水平，并且有着健康的社区。(在此之前，它已经被很多公司用到了生产环境)",-1),i("h1",{id:"为什么选择-kubevirt",tabindex:"-1"},[t("为什么选择 KubeVirt？ "),i("a",{class:"header-anchor",href:"#为什么选择-kubevirt","aria-label":'Permalink to "为什么选择 KubeVirt？"'},"​")],-1),i("p",null,[t("​ KubeVirt 技术满足了已经采用或想要采用 "),i("a",{href:"https://kubernetes.io/",target:"_blank",rel:"noreferrer"},"Kubernetes"),t(" 的开发团队的需求，但 拥有无法轻松容器化的基于虚拟机的现有工作负载。更具体地说， 技术提供了一个统一的开发平台，开发人员可以在其中构建、修改和部署应用程序 驻留在应用程序容器和虚拟机中，位于一个公共的共享环境中。")],-1),i("p",null,"​ 好处是广泛而显着的。依赖于现有基于虚拟机的工作负载的团队是 能够快速容器化应用程序。通过将虚拟化工作负载直接放置在开发工作流中， 团队可以随着时间的推移分解它们，同时仍然根据需要利用剩余的虚拟化组件。",-1),i("h1",{id:"必要条件",tabindex:"-1"},[t("必要条件 "),i("a",{class:"header-anchor",href:"#必要条件","aria-label":'Permalink to "必要条件"'},"​")],-1),i("p",null,[t("KubeVirt 需要 BIOS 支持虚拟化，也就是必须拥有 支持 VT-x（vmx）的 Intel 处理器 或者支持 AMD-V (svm) 技术的 AMD 处理器，使用"),i("code",null,"grep -Eoc '(vmx|svm)' /proc/cpuinfo"),t("查看是否支持虚拟化，若输出不为0则支持虚拟化，可以运行 KubeVirt。")],-1),i("h1",{id:"在-kubernetes-中安装-kubevirt",tabindex:"-1"},[t("在 Kubernetes 中安装 KubeVirt "),i("a",{class:"header-anchor",href:"#在-kubernetes-中安装-kubevirt","aria-label":'Permalink to "在 Kubernetes 中安装 KubeVirt"'},"​")],-1),i("h2",{id:"部署kubevirt-operator",tabindex:"-1"},[t("部署KubeVirt operator "),i("a",{class:"header-anchor",href:"#部署kubevirt-operator","aria-label":'Permalink to "部署KubeVirt operator"'},"​")],-1),i("p",null,"设置版本环境变量",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"export"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," VERSION"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"curl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://storage.googleapis.com/kubevirt-prow/release/kubevirt/kubevirt/stable.txt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),t(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"echo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $VERSION")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"创建资源",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"kubectl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," create"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/kubevirt/kubevirt/releases/download/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"${VERSION}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/kubevirt-operator.yaml")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"部署-kubevirt-自定义资源定义",tabindex:"-1"},[t("部署 KubeVirt 自定义资源定义 "),i("a",{class:"header-anchor",href:"#部署-kubevirt-自定义资源定义","aria-label":'Permalink to "部署 KubeVirt 自定义资源定义"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"kubectl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," create"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/kubevirt/kubevirt/releases/download/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"${VERSION}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/kubevirt-cr.yaml")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"检查部署",tabindex:"-1"},[t("检查部署 "),i("a",{class:"header-anchor",href:"#检查部署","aria-label":'Permalink to "检查部署"'},"​")],-1),i("p",null,"默认情况下，KubeVirt 将部署 7 个 Pod、3 个Services、1 个daemonset、3 个deployment、3 个replica sets。",-1),i("ul",null,[i("li",null,[i("p",null,"检查部署："),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"kubectl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," get"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kubevirt.kubevirt.io/kubevirt"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kubevirt"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o=jsonpath="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"{.status.phase}"')])])]),i("button",{class:"code-block-unfold-btn"})])]),i("li",null,[i("p",null,"检查组件："),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"kubectl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," get"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," all"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kubevirt")])])]),i("button",{class:"code-block-unfold-btn"})])])],-1),i("h2",{id:"virtctl",tabindex:"-1"},[t("Virtctl "),i("a",{class:"header-anchor",href:"#virtctl","aria-label":'Permalink to "Virtctl"'},"​")],-1),i("blockquote",null,[i("p",null,"KubeVirt 提供名为 virtctl 的附加二进制文件，用于快速访问虚拟机的串行和图形端口，并处理启动/停止操作。")],-1),i("h3",{id:"install",tabindex:"-1"},[t("Install "),i("a",{class:"header-anchor",href:"#install","aria-label":'Permalink to "Install"'},"​")],-1),i("p",null,[i("code",null,"virtctl"),t(" 可从 KubeVirt github 页面的发布页面获取。")],-1),i("ul",null,[i("li",null,[i("p",null,"使用这些命令安装:"),i("ul",null,[i("li",null,[i("p",null,[t("设置版本"),i("code",null,'VERSION=$(kubectl get kubevirt.kubevirt.io/kubevirt -n kubevirt -o=jsonpath="{.status.observedKubeVirtVersion}")')])]),i("li",null,[i("p",null,[t("设置架构"),i("code",null,"ARCH=$(uname -s | tr A-Z a-z)-$(uname -m | sed 's/x86_64/amd64/') || windows-amd64.exe")])]),i("li",null,[i("p",null,[t("查看架构"),i("code",null,"echo ${ARCH}")])]),i("li",null,[i("p",null,[t("下载文件"),i("code",null,"curl -L -o virtctl https://github.com/kubevirt/kubevirt/releases/download/${VERSION}/virtctl-${VERSION}-${ARCH}")])]),i("li",null,[i("p",null,"安装"),i("ul",null,[i("li",null,[i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"chmod"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," +x"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," virtctl")]),t(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sudo"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," virtctl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /usr/local/bin")])])]),i("button",{class:"code-block-unfold-btn"})])])])])])])],-1),i("h3",{id:"install-as-krew-plugin",tabindex:"-1"},[t("Install as Krew plugin "),i("a",{class:"header-anchor",href:"#install-as-krew-plugin","aria-label":'Permalink to "Install as Krew plugin"'},"​")],-1),i("p",null,[i("code",null,"virtctl"),t(" can be installed as a plugin via the "),i("code",null,"krew"),t(" plugin manager("),i("a",{href:"https://krew.dev/",target:"_blank",rel:"noreferrer"},"https://krew.dev/"),t("). Occurrences of can then be read as ."),i("code",null,"virtctl <command>...kubectl virt <command>...")],-1),i("ul",null,[i("li",null,[i("p",null,"Run the following to install:"),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"kubectl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," krew"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," virt")])])]),i("button",{class:"code-block-unfold-btn"})])])],-1),i("h1",{id:"接下来",tabindex:"-1"},[t("接下来… "),i("a",{class:"header-anchor",href:"#接下来","aria-label":'Permalink to "接下来..."'},"​")],-1),i("p",null,[t("还没写完，请参照文章"),i("a",{href:"https://kubevirt.io/labs/kubernetes/lab2",target:"_blank",rel:"noreferrer"},"使用 CDI 进行实验 |KubeVirt.io")],-1)])]),"main-header":e(()=>[a(s.$slots,"main-header")]),"main-header-after":e(()=>[a(s.$slots,"main-header-after")]),"main-nav":e(()=>[a(s.$slots,"main-nav")]),"main-content-before":e(()=>[a(s.$slots,"main-content-before")]),"main-content":e(()=>[a(s.$slots,"main-content")]),"main-content-after":e(()=>[a(s.$slots,"main-content-after")]),"main-nav-before":e(()=>[a(s.$slots,"main-nav-before")]),"main-nav-after":e(()=>[a(s.$slots,"main-nav-after")]),comment:e(()=>[a(s.$slots,"comment")]),footer:e(()=>[a(s.$slots,"footer")]),aside:e(()=>[a(s.$slots,"aside")]),"aside-custom":e(()=>[a(s.$slots,"aside-custom")]),default:e(()=>[a(s.$slots,"default")]),_:3},8,["frontmatter"])}}};export{A as default,f as usePageData};
