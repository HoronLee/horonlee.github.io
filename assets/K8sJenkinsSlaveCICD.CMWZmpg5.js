import{_ as d}from"./ValaxyMain.vue_vue_type_style_index_0_lang.BKY0BFev.js";import"./chunks/@vueuse/motion.C1YF0VrX.js";import{d as g,u as E,a as y}from"./chunks/vue-router.B0lpXBWQ.js";import{X as u,b3 as F,b_ as l,be as a,_ as i,a5 as s,bB as B,b5 as f}from"./framework.tSB2Odh-.js";import"./app.CfWrNu88.js";import"./chunks/dayjs.BmWuu2Zz.js";import"./chunks/vue-i18n.CP2UHYEb.js";import"./chunks/pinia.BF0-M7Fk.js";import"./chunks/nprogress.YXB5kar1.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.DoC94HOc.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.CBF25nPr.js";import"./post.TKccRjPH.js";const b="/attachment/K8sJenkinsSlaveCICD/0b489e311b5b45e574814990a45fb21b.png",m="/attachment/K8sJenkinsSlaveCICD/5b86f1537c409e568d2dcf94e64a02cd.png",D="/attachment/K8sJenkinsSlaveCICD/9b336640664bd348ece99f30fbcefda0.png",C="/attachment/K8sJenkinsSlaveCICD/946290a3c2091ddaa7b912e9ee5bd04e.png",v="/attachment/K8sJenkinsSlaveCICD/98901ba24512e988e1ec0e4671b64197.png",A="/attachment/K8sJenkinsSlaveCICD/372e2b973fc459b466f4aff23d8803e4.png",j="/attachment/K8sJenkinsSlaveCICD/d953a2e1c3f6ec4e582f16d80169cbd6.png",P="/attachment/K8sJenkinsSlaveCICD/b7dc69fe9e8373ad6772bf7459c0c467.png",_="/attachment/K8sJenkinsSlaveCICD/10f7a756c0cb6faba2fe1e8503306205.png",S="/attachment/K8sJenkinsSlaveCICD/5043353c0c6a28475e97d3dfe3fd5ca3.png",x="/attachment/K8sJenkinsSlaveCICD/807955afc089205f93637c40c8aa0e90.png",R="/attachment/K8sJenkinsSlaveCICD/0a317e0774105ec4e51f7d1e72c43f56.png",I="/attachment/K8sJenkinsSlaveCICD/8102a2a36ddd415b5e66b5bfbee37bca.png",T="/attachment/K8sJenkinsSlaveCICD/3d2d07f1e7c31a845649d52cbc340692.png",G=g("/posts/K8sJenkinsSlaveCICD",async t=>JSON.parse('{"title":"Jenkinsçš„æ ‡å‡†ç”¨æ³•â€œJenkins-Slaveâ€","description":"","frontmatter":{"layout":"post","title":"Jenkinsçš„æ ‡å‡†ç”¨æ³•â€œJenkins-Slaveâ€","date":"2024-05-24 11:42:20","tags":["Linux","Kubernetes","äº‘è®¡ç®—","CICD","Jenkins"],"categories":["æœåŠ¡å™¨è¿ç»´","äº‘è®¡ç®—","Jenkins"],"cover":"https://i2.wp.com/digitalvarys.com/wp-content/uploads/2019/05/jenkins-master-slave-config.png?fit=1963%2C1079&ssl=1","password":null,"hide":null},"headers":[],"relativePath":"pages/posts/K8sJenkinsSlaveCICD.md","lastUpdated":1767692976000}'),{lazy:(t,e)=>t.name===e.name}),Q={__name:"K8sJenkinsSlaveCICD",setup(t,{expose:e}){const{data:k}=G(),r=E(),o=y(),h=Object.assign(o.meta.frontmatter||{},k.value?.frontmatter||{});return r.currentRoute.value.data=k.value,f("valaxy:frontmatter",h),globalThis.$frontmatter=h,e({frontmatter:{layout:"post",title:"Jenkinsçš„æ ‡å‡†ç”¨æ³•â€œJenkins-Slaveâ€",date:"2024-05-24 11:42:20",tags:["Linux","Kubernetes","äº‘è®¡ç®—","CICD","Jenkins"],categories:["æœåŠ¡å™¨è¿ç»´","äº‘è®¡ç®—","Jenkins"],cover:"https://i2.wp.com/digitalvarys.com/wp-content/uploads/2019/05/jenkins-master-slave-config.png?fit=1963%2C1079&ssl=1",password:null,hide:null}}),(n,p)=>{const c=d;return F(),u(c,{frontmatter:B(h)},{"main-content-md":l(()=>[...p[0]||(p[0]=[i("h1",{id:"kubernetesæ„å»º-jenkins-master-slave-æ¶æ„",tabindex:"-1"},[s("kubernetesæ„å»º Jenkins-Master&Slave æ¶æ„ "),i("a",{class:"header-anchor",href:"#kubernetesæ„å»º-jenkins-master-slave-æ¶æ„","aria-label":'Permalink to "kubernetesæ„å»º Jenkins-Master&Slave æ¶æ„"'},"â€‹")],-1),i("h2",{id:"å¼•å­",tabindex:"-1"},[s("å¼•å­ "),i("a",{class:"header-anchor",href:"#å¼•å­","aria-label":'Permalink to "å¼•å­"'},"â€‹")],-1),i("p",null,"è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘åœ¨å­¦æ ¡å¸®åŠ©ä¸“ä¸šè€å¸ˆæ’°å†™çš„ï¼Œæ—¨åœ¨äºå¸®åŠ©åŒå­¦æ›´å¥½çš„å­¦ä¹  Jenkins çš„ä½¿ç”¨ï¼Œæ‰€æœ‰å†…å®¹éƒ½æ˜¯åŸºäºæœ€æ–°çš„å®˜æ–¹æ–‡æ¡£ç¼–å†™ï¼Œä¸”ç»è¿‡æ£€éªŒï¼Œå¯ä»¥æ”¾å¿ƒé£Ÿç”¨ï¼",-1),i("p",null,"ä¸‹é¢å°±æ˜¯æ­£æ–‡äº†ï¼Œenjoy:D",-1),i("h2",{id:"å‡†å¤‡å·¥ä½œ",tabindex:"-1"},[s("å‡†å¤‡å·¥ä½œ "),i("a",{class:"header-anchor",href:"#å‡†å¤‡å·¥ä½œ","aria-label":'Permalink to "å‡†å¤‡å·¥ä½œ"'},"â€‹")],-1),i("p",null,"è™šæ‹ŸæœºèŠ‚ç‚¹ä¿¡æ¯ï¼š",-1),i("ul",null,[i("li",null,[i("p",null,"master èŠ‚ç‚¹ï¼š172.30.26.172"),i("ul",null,[i("li",null,[i("p",null,"4 ä¸ª vCPU")]),i("li",null,[i("p",null,"4G å†…å­˜")])])]),i("li",null,[i("p",null,"worker1èŠ‚ç‚¹ï¼š172.30.26.173ï¼ˆæ ‡è®°ä¸º worker tagï¼Œpod ä¸»åŠ¨åœ¨æ­¤èŠ‚ç‚¹è¿è¡Œï¼‰"),i("ul",null,[i("li",null,"8 ä¸ª vCPU"),i("li",null,"16G å†…å­˜ï¼ˆ12G å†…å­˜è¶³å¤Ÿï¼‰")])])],-1),i("p",null,"ç›¸å…³é•œåƒï¼š",-1),i("ol",null,[i("li",null,[s("["),i("a",{href:"https://hub.docker.com/r/jenkins/jenkins",target:"_blank",rel:"noreferrer"},"jenkins/jenkins - Docker Image | Docker Hub"),s("]("),i("a",{href:"https://hub.docker.com/_/jenkins",target:"_blank",rel:"noreferrer"},"https://hub.docker.com/_/jenkins"),s(")")]),i("li",null,[i("a",{href:"https://hub.docker.com/r/jenkins/inbound-agent/",target:"_blank",rel:"noreferrer"},"jenkins/inbound-agent - Docker é•œåƒ |Docker ä¸­å¿ƒ")]),i("li",null,[i("a",{href:"https://hub.docker.com/r/gitlab/gitlab-ce",target:"_blank",rel:"noreferrer"},"gitlab/gitlab-ce - Docker Image | Docker Hub")])],-1),i("p",null,[s("æ‰€ç”¨é¡¹ç›®ï¼š"),i("a",{href:"https://github.com/YunYouJun/valaxy",target:"_blank",rel:"noreferrer"},"YunYouJun/valaxy: ğŸŒŒ Next Generation Static Blog Framework (Beta) ä¸‹ä¸€ä»£é™æ€åšå®¢æ¡†æ¶ï¼ˆæ”¯æŒé¡µé¢/é…ç½®çƒ­é‡è½½ï¼‰ (github.com)"),s("ï¼Œæœ¬æ–‡æ›´æ”¹äº† Dockerfileï¼Œåˆ é™¤äº†ç¬¬ä¸€é˜¶æ®µçš„æ„å»ºï¼")],-1),i("hr",null,null,-1),i("p",null,[s("å°† master èŠ‚ç‚¹çš„"),i("code",null,".kube"),s("é…ç½®æ–‡ä»¶æ‹·è´åˆ° worker1 èŠ‚ç‚¹ï¼Œæ–¹ä¾¿åç»­çš„å·¥ä½œ")],-1),i("p",null,[i("code",null,"scp -r /root/.kube worker1:/root")],-1),i("h3",{id:"è®¾ç½®jenkinsmasterå®¹å¿åº¦",tabindex:"-1"},[s("è®¾ç½®JenkinsMasterå®¹å¿åº¦ "),i("a",{class:"header-anchor",href:"#è®¾ç½®jenkinsmasterå®¹å¿åº¦","aria-label":'Permalink to "è®¾ç½®JenkinsMasterå®¹å¿åº¦"'},"â€‹")],-1),i("blockquote",null,[i("p",null,"kubernetes åœ¨å®‰è£…å®Œæˆåä¼šåœ¨ master èŠ‚ç‚¹æ·»åŠ ä¸€ä¸ªåä¸º control-plane çš„æ±¡ç‚¹ï¼Œè¿™ä¸ªæ±¡ç‚¹ä¸ä¼šå®¹å¿ä»»ä½•éæŒ‡å®šçš„ pod è¿è¡Œåœ¨ master èŠ‚ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦è®² jenkins-master å®‰æ’åœ¨ master èŠ‚ç‚¹ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿä»¥ä¸‹æ˜¯å¤„ç†æ€è·¯ã€‚")],-1),i("p",null,[s("æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç§»é™¤æ‰€æœ‰èŠ‚ç‚¹çš„ control-plane æ±¡ç‚¹ "),i("code",null,"kubectl taint nodes --all node-role.kubernetes.io/control-plane-"),s("ï¼Œç„¶åå†æŒ‡å®š"),i("code",null,"nodeSelector"),s("ã€‚(nodeSelectorçš„ç”¨æ³•çœ‹ç¬¬äºŒç§æ–¹æ³•)")],-1),i("blockquote",null,[i("p",null,"è¿˜æœ‰ä¸€ç§æ–¹æ³•æˆ‘æ›´æ¨èï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¹Ÿå¯ä»¥è¿™æ ·æ“ä½œï¼š")],-1),i("p",null,[s("ä¸º master èŠ‚ç‚¹æ‰“ä¸Šæ ‡ç­¾"),i("code",null,"jenkins=master"),s("ï¼š"),i("code",null,"kubectl label no master jenkins=master")],-1),i("p",null,"åœ¨åˆ›å»º jenkins-master çš„æ—¶å€™ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨ï¼Œå°±å¯ä»¥å¼ºåˆ¶è®© pod è¿è¡Œåœ¨æœ‰ NoSchedule çš„Taints çš„ä¸»èŠ‚ç‚¹ä¸Š",-1),i("p",null,[s("ä½†æ˜¯æ­¤æ—¶è¿˜æ˜¯ä¸èƒ½è®© pod æˆåŠŸè°ƒåº¦åˆ° master èŠ‚ç‚¹ï¼Œå› ä¸º master èŠ‚ç‚¹åœ¨åˆå§‹åŒ–æ—¶å°±è¢«æ ‡è®°äº†"),i("a",{href:"https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/taint-and-toleration/",target:"_blank",rel:"noreferrer"},"æ±¡ç‚¹"),s("â€œnode-role.kubernetes.io/control-planeâ€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸º master èŠ‚ç‚¹é…ç½®å®¹å¿åº¦ï¼Œå…è®¸æ‹¥æœ‰ç‰¹å®šé”®å€¼å¯¹æ ‡ç­¾çš„ pod è¿è¡Œåœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸Šã€‚")],-1),i("p",null,[s("æ‰€ä»¥éœ€è¦åœ¨"),i("code",null,"spec.template.spec"),s("é…ç½®ä»¥ä¸‹å†…å®¹ï¼š")],-1),i("div",{class:"language-yaml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"yaml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"nodeSelector"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  jenkins"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"master"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"tolerations"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  - "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"key"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"node-role.kubernetes.io/control-plane"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    operator"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Exists"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    effect"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"NoSchedule"')])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("blockquote",null,[i("p",null,"è®¾ç½®HTTPè®¿é—®é•œåƒä»“åº“ï¼ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½è¦åšï¼‰ï¼š/etc/containerd/config")],-1),i("p",null,"Containerdä»v1.5ä¹‹åå°±ä¸æ¨èäº†ä»¥config.tomlä½œä¸ºé•œåƒä»“åº“çš„é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨æ–°çš„é…ç½®æ–¹æ³•",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mkdir"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/containerd/certs.d/172.30.26.172")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"vim"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/containerd/certs.d/172.30.26.172/hosts.toml")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"åœ¨æ–‡ä»¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹",-1),i("div",{class:"language-toml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"toml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"server = "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://172.30.26.172"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"host"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"http://172'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"30"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"26"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'172"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"capabilities = ["),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"pull"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"resolve"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"push"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"skip_verify = "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[s("ç„¶åé‡å¯ "),i("code",null,"systemctl restart containerd ")],-1),i("h2",{id:"å®‰è£…-harbor-é•œåƒä»“åº“",tabindex:"-1"},[s("å®‰è£… Harbor é•œåƒä»“åº“ "),i("a",{class:"header-anchor",href:"#å®‰è£…-harbor-é•œåƒä»“åº“","aria-label":'Permalink to "å®‰è£… Harbor é•œåƒä»“åº“"'},"â€‹")],-1),i("blockquote",null,[i("p",null,[s("å®˜æ–¹ä¸‹è½½åœ°å€ï¼š"),i("a",{href:"https://github.com/goharbor/harbor/releases",target:"_blank",rel:"noreferrer"},"Releases Â· goharbor/harbor (github.com)")])],-1),i("p",null,"å°†harbor-offline-installer-v2.9.4.tgzä¸‹è½½åˆ°optç›®å½•ä¸‹",-1),i("p",null,[i("code",null,"curl -O http://172.30.27.143/CICD/harbor-offline-installer-v2.9.4.tgz")],-1),i("p",null,[s("è§£å‹æ–‡ä»¶"),i("code",null,"tar xvf harbor-offline-installer-v2.9.4.tgz")],-1),i("p",null,[s("è¿›å…¥harborå®‰è£…ç›®å½•"),i("code",null,"cd harbor")],-1),i("p",null,[s("ç¼–å†™å®‰è£…é…"),i("code",null,"cp harbor.yml.tmpl harbor.yml")],-1),i("p",null,[i("code",null,"vim harbor.yml")],-1),i("p",null,"å°†ç¬¬äº”è¡Œhostname:åé¢çš„IPæ”¹ä¸ºMasterèŠ‚ç‚¹IP",-1),i("p",null,[i("code",null,"hostname: http://172.30.26.172/")],-1),i("p",null,"åˆ é™¤é‡Œé¢13-18è¡Œä»¥å–æ¶ˆhttpsé…ç½®",-1),i("p",null,[s("æ‰§è¡Œè„šæœ¬æ¥å®‰è£…harbor"),i("code",null,"./install.sh")],-1),i("figure",null,[i("img",{src:b,alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"å‡ºç°å¦‚å›¾å›æ˜¾è¯´æ˜Harborå®‰è£…å®Œæˆ",-1),i("p",null,"è®¿é—®Harbor",-1),i("p",null,[i("a",{href:"http://172.30.26.172/",target:"_blank",rel:"noreferrer"},"http://172.30.26.172/")],-1),i("p",null,"â€‹ è´¦å·ï¼šadmin",-1),i("p",null,"â€‹ å¯†ç ï¼šHarbor12345",-1),i("p",null,"ç™»å½• Harbor ä»“åº“",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"[root@master ~]# docker login 172.30.26.172")]),s(`
`),i("span",{class:"line"},[i("span",null,"Username: admin")]),s(`
`),i("span",{class:"line"},[i("span",null,"Password:")]),s(`
`),i("span",{class:"line"},[i("span",null,"WARNING! Your password will be stored unencrypted in /root/.docker/config.json.")]),s(`
`),i("span",{class:"line"},[i("span",null,"Configure a credential helper to remove this warning. See")]),s(`
`),i("span",{class:"line"},[i("span",null,"https://docs.docker.com/engine/reference/commandline/login/#credentials-store")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"éƒ¨ç½²-gitea",tabindex:"-1"},[s("éƒ¨ç½² Gitea "),i("a",{class:"header-anchor",href:"#éƒ¨ç½²-gitea","aria-label":'Permalink to "éƒ¨ç½² Gitea"'},"â€‹")],-1),i("blockquote",null,[i("p",null,[s("ä»€ä¹ˆæ˜¯ Giteaï¼ŸGitea æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ DevOps å¹³å°è½¯ä»¶ã€‚ä»å¼€å‘è®¡åˆ’åˆ°äº§å“æˆå‹çš„æ•´ä¸ªè½¯ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œä»–éƒ½èƒ½å¤Ÿé«˜æ•ˆè€Œè½»æ¾çš„å¸®åŠ©å›¢é˜Ÿå’Œå¼€å‘è€…ã€‚åŒ…æ‹¬ Git æ‰˜ç®¡ã€ä»£ç å®¡æŸ¥ã€å›¢é˜Ÿåä½œã€è½¯ä»¶åŒ…æ³¨å†Œå’Œ CI/CDã€‚å®ƒä¸ GitHubã€Bitbucket å’Œ GitLab ç­‰æ¯”è¾ƒç±»ä¼¼ã€‚ Gitea æœ€åˆæ˜¯ä» "),i("a",{href:"http://gogs.io/",target:"_blank",rel:"noreferrer"},"Gogs"),s(" åˆ†æ”¯è€Œæ¥ï¼Œå‡ ä¹æ‰€æœ‰ä»£ç éƒ½å·²æ›´æ”¹ã€‚å¯¹äºæˆ‘ä»¬Forkçš„åŸå› å¯ä»¥çœ‹ "),i("a",{href:"https://blog.gitea.com/welcome-to-gitea/",target:"_blank",rel:"noreferrer"},"è¿™é‡Œ"),s("ã€‚")])],-1),i("h3",{id:"ä½¿ç”¨-docker-å®‰è£…-gitea",tabindex:"-1"},[s("ä½¿ç”¨ docker å®‰è£… Gitea "),i("a",{class:"header-anchor",href:"#ä½¿ç”¨-docker-å®‰è£…-gitea","aria-label":'Permalink to "ä½¿ç”¨ docker å®‰è£… Gitea"'},"â€‹")],-1),i("p",null,"âš ï¸Gitea éƒ¨ç½²åœ¨ worker1 èŠ‚ç‚¹",-1),i("p",null,"åœ¨ root ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ giteaï¼Œå¹¶è¿›å…¥ï¼Œåˆ›å»º docker-compose.yaml æ–‡ä»¶å¹¶ç¼–è¾‘",-1),i("p",null,[i("code",null,"mkdir gitea && cd gitea && vim docker-compose.yaml")],-1),i("div",{class:"language-yaml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"yaml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"3"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"networks"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  gitea"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    external"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"services"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  server"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"gitea/gitea:1.21.11")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    container_name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    environment"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"USER_UID=1000")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"USER_GID=1000")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"GITEA__database__DB_TYPE=mysql")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"GITEA__database__HOST=db:3306")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"GITEA__database__NAME=gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"GITEA__database__USER=gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"GITEA__database__PASSWD=gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    restart"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"always")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    networks"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    volumes"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./gitea:/data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/etc/timezone:/etc/timezone:ro")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/etc/localtime:/etc/localtime:ro")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    ports"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"3000:3000"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"222:22"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    depends_on"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"db")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  db"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"mysql:5.7.39")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    restart"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"always")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    environment"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"MYSQL_ROOT_PASSWORD=gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"MYSQL_USER=gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"MYSQL_PASSWORD=gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"MYSQL_DATABASE=gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    networks"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"gitea")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    volumes"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./mysql:/var/lib/mysql")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[s("å¯åŠ¨ docker composeï¼š"),i("code",null,"docker compose up -d")],-1),i("p",null,[s("çœ‹åˆ° docker compose éƒ½å¯åŠ¨ä¹‹åï¼Œè¿›å…¥ç½‘é¡µè¿›è¡Œå®‰è£…"),i("a",{href:"http://172.30.26.173:3000/",target:"_blank",rel:"noreferrer"},"http://172.30.26.173:3000/")],-1),i("p",null,"ç¼–è¾‘æ•°æ®åº“çš„è¿æ¥é…ç½®ï¼ˆé»˜è®¤å¯ä»¥ä¸æ”¹ï¼‰ï¼Œè®¾ç½®ç®¡ç†å‘˜ä¿¡æ¯",-1),i("ul",null,[i("li",null,"ç®¡ç†å‘˜ç”¨æˆ·åroot"),i("li",null,"ç”µå­é‚®ä»¶admin@example.com"),i("li",null,"å¯†ç  000000")],-1),i("p",null,[s("ç„¶åç‚¹å‡» "),i("code",null,"ç«‹å³å®‰è£…"),s("ï¼Œç¨ç­‰ç‰‡åˆ»å³å¯è¿›å…¥ç™»å½•é¡µé¢ï¼Œè¾“å…¥è´¦å·å¯†ç ï¼Œè¿›å…¥ä¸»é¡µ")],-1),i("figure",null,[i("img",{src:m,alt:"",loading:"lazy",decoding:"async"})],-1),i("h3",{id:"ä½¿ç”¨-helm-å®‰è£…gitea",tabindex:"-1"},[s("ä½¿ç”¨ Helm å®‰è£…Gitea "),i("a",{class:"header-anchor",href:"#ä½¿ç”¨-helm-å®‰è£…gitea","aria-label":'Permalink to "ä½¿ç”¨ Helm å®‰è£…Gitea"'},"â€‹")],-1),i("blockquote",null,[i("p",null,"å®‰è£… Helm")],-1),i("p",null,[s("ä»€ä¹ˆæ˜¯ "),i("a",{href:"https://helm.sh/zh/docs/intro/quickstart/",target:"_blank",rel:"noreferrer"},"Helm |å¿«é€Ÿå…¥é—¨æŒ‡å— (helm.sh)"),s("ï¼Ÿ")],-1),i("ol",null,[i("li",null,[i("code",null,"wget http://172.30.27.143/CICD/helm-v3.15.0-linux-amd64.tar.gz")]),i("li",null,[i("code",null,"tar zxf helm-v3.15.0-linux-amd64.tar.gz")]),i("li",null,[i("code",null,"mv linux-amd64/helm /usr/local/bin/helm")]),i("li",null,[i("code",null,"rm -rf linux-amd64/")])],-1),i("blockquote",null,[i("p",null,"å®‰è£… Gitea")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"helm"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," repo"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," add"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," gitea"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://dl.gitea.com/charts")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"helm"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," repo"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," update")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"helm"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," gitea"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," gitea/gitea")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"æ–°å»º-git-é¡¹ç›®",tabindex:"-1"},[s("æ–°å»º Git é¡¹ç›® "),i("a",{class:"header-anchor",href:"#æ–°å»º-git-é¡¹ç›®","aria-label":'Permalink to "æ–°å»º Git é¡¹ç›®"'},"â€‹")],-1),i("p",null,[s("ç‚¹å‡»ä»“åº“åˆ—è¡¨è¾¹ä¸Šçš„â•å·ï¼Œå¼€å§‹æ·»åŠ ä»“åº“çš„æ­¥éª¤ï¼Œåç§°å¡«å†™ "),i("code",null,"valaxy"),s("ï¼Œç„¶åç›´æ¥ç‚¹å‡»æœ€ä¸‹é¢çš„æŒ‰é’®æ–°å»ºä»“åº“")],-1),i("h3",{id:"åˆ›å»ºæœ¬åœ°é¡¹ç›®",tabindex:"-1"},[s("åˆ›å»ºæœ¬åœ°é¡¹ç›® "),i("a",{class:"header-anchor",href:"#åˆ›å»ºæœ¬åœ°é¡¹ç›®","aria-label":'Permalink to "åˆ›å»ºæœ¬åœ°é¡¹ç›®"'},"â€‹")],-1),i("p",null,[s("ä¸‹è½½é¡¹ç›® wget "),i("a",{href:"http://172.30.27.143/CICD/jenkins-slave/ValaxyBlogProject.tar.gz",target:"_blank",rel:"noreferrer"},"http://172.30.27.143/CICD/jenkins-slave/ValaxyBlogProject.tar.gz")],-1),i("p",null,[s("è§£å‹é¡¹ç›® "),i("code",null,"tar zxf valaxy-blog.tar.gz")],-1),i("p",null,[s("è¿›å…¥é¡¹ç›®æ–‡ä»¶ "),i("code",null,"cd valaxy-blog")],-1),i("h3",{id:"ä¸Šä¼ é¡¹ç›®",tabindex:"-1"},[s("ä¸Šä¼ é¡¹ç›® "),i("a",{class:"header-anchor",href:"#ä¸Šä¼ é¡¹ç›®","aria-label":'Permalink to "ä¸Šä¼ é¡¹ç›®"'},"â€‹")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," init")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," checkout"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -b"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," main")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," add"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," commit"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "first commit"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," remote"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," add"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," origin"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," http://172.30.26.173:3000/root/valaxy.git")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," push"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -u"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," origin"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," main")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@master valaxy-blog]# git push -u origin main")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Username"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," for"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'http://172.30.26.173:3000':"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," root"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"	//è¾“å…¥ä¹‹å‰çš„è´¦å·å¯†ç å³å¯")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Password"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," for"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'http://root@172.30.26.173:3000':")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Counting"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," objects:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 56,"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," done.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Delta"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," compression"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," using"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," up"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," to"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 4"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," threads.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Compressing"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," objects:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 100%"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (41/41), done.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Writing"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," objects:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 100%"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (56/56), 101.45 KiB "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"|"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," 0"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bytes/s,"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," done.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Total"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 56"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (delta "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"), reused 0 ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delta"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"remote:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ."),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Processing"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," references")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"remote:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Processed"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," references"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," in"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," total")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"To"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," http://172.30.26.173:3000/root/valaxy.git")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," *"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," [new "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"branch]"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"      main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," main")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"åˆ†æ”¯"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," main"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," è®¾ç½®ä¸ºè·Ÿè¸ªæ¥è‡ª"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," origin"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," çš„è¿œç¨‹åˆ†æ”¯"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," mainã€‚")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"åˆ·æ–° gitea ç½‘é¡µï¼Œå³å¯çœ‹åˆ°é¡¹ç›®ä¸Šä¼ å®Œæˆ",-1),i("h2",{id:"å®‰è£…jenkins-master",tabindex:"-1"},[s("å®‰è£…Jenkins-Master "),i("a",{class:"header-anchor",href:"#å®‰è£…jenkins-master","aria-label":'Permalink to "å®‰è£…Jenkins-Master"'},"â€‹")],-1),i("h3",{id:"é…ç½®-nfs",tabindex:"-1"},[s("é…ç½® NFS "),i("a",{class:"header-anchor",href:"#é…ç½®-nfs","aria-label":'Permalink to "é…ç½® NFS"'},"â€‹")],-1),i("p",null,"å®‰è£…NFSæœåŠ¡ï¼ˆè¿™ä¸ªéœ€è¦åœ¨æ‰€æœ‰K8Sçš„èŠ‚ç‚¹ä¸Šå®‰è£…ï¼‰",-1),i("p",null,[i("code",null,"yum install -y nfs-utils")],-1),i("p",null,"åˆ›å»ºå…±äº«ç›®å½•ï¼ˆè¿™ä¸ªåªéœ€è¦åœ¨masterèŠ‚ç‚¹ï¼‰",-1),i("p",null,[i("code",null,"mkdir -p /opt/nfs/jenkins")],-1),i("p",null,"ç¼–å†™NFSçš„å…±äº«é…ç½®",-1),i("p",null,[i("code",null,"vim /etc/exports")],-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"/opt/nfs/jenkins *(rw,no_root_squash)")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[i("code",null,"*"),s("ä»£è¡¨å¯¹æ‰€æœ‰IPéƒ½å¼€æ”¾æ­¤ç›®å½•ï¼Œ"),i("code",null,"rw"),s("æ˜¯è¯»å†™ï¼Œ"),i("code",null,"no_root_squash"),s("ä¸å‹åˆ¶rootæƒé™")],-1),i("p",null,"å¯åŠ¨æœåŠ¡",-1),i("p",null,[i("code",null,"systemctl enable nfs --now")],-1),i("p",null,"æŸ¥çœ‹NFSå…±äº«ç›®å½•",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@master "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# showmount -e 172.30.26.172")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Export"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," list"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," for"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 172.30.26.172:")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"/opt/nfs/jenkins"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," *")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("hr",null,null,-1),i("p",null,"åˆ›å»ºå¹¶è¿›å…¥jenkinsç›®å½•",-1),i("p",null,[i("code",null,"mkdir jenkins && cd jenkins")],-1),i("p",null,[i("strong",null,"æ­¥éª¤ 1"),s("ï¼šä¸º Jenkins åˆ›å»ºå‘½åç©ºé—´ã€‚ æœ€å¥½å°†æ‰€æœ‰ DevOps å·¥å…·åˆ†ç±»ä¸ºä¸å…¶ä»–åº”ç”¨ç¨‹åºä¸åŒçš„å‘½åç©ºé—´ã€‚")],-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"kubectl create namespace devops")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"**æ­¥éª¤2ï¼š**åˆ›å»ºâ€œserviceAccount.yamlâ€æ–‡ä»¶å¹¶å¤åˆ¶ä»¥ä¸‹ç®¡ç†å‘˜æœåŠ¡å¸æˆ·æ¸…å•ã€‚",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"apiVersion: rbac.authorization.k8s.io/v1")]),s(`
`),i("span",{class:"line"},[i("span",null,"kind: ClusterRole")]),s(`
`),i("span",{class:"line"},[i("span",null,"metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins-admin")]),s(`
`),i("span",{class:"line"},[i("span",null,"rules:")]),s(`
`),i("span",{class:"line"},[i("span",null,'  - apiGroups: [""]')]),s(`
`),i("span",{class:"line"},[i("span",null,'    resources: ["*"]')]),s(`
`),i("span",{class:"line"},[i("span",null,'    verbs: ["*"]')]),s(`
`),i("span",{class:"line"},[i("span",null,"---")]),s(`
`),i("span",{class:"line"},[i("span",null,"apiVersion: v1")]),s(`
`),i("span",{class:"line"},[i("span",null,"kind: ServiceAccount")]),s(`
`),i("span",{class:"line"},[i("span",null,"metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins-admin")]),s(`
`),i("span",{class:"line"},[i("span",null,"  namespace: devops")]),s(`
`),i("span",{class:"line"},[i("span",null,"---")]),s(`
`),i("span",{class:"line"},[i("span",null,"apiVersion: rbac.authorization.k8s.io/v1")]),s(`
`),i("span",{class:"line"},[i("span",null,"kind: ClusterRoleBinding")]),s(`
`),i("span",{class:"line"},[i("span",null,"metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins-admin")]),s(`
`),i("span",{class:"line"},[i("span",null,"roleRef:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  apiGroup: rbac.authorization.k8s.io")]),s(`
`),i("span",{class:"line"},[i("span",null,"  kind: ClusterRole")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins-admin")]),s(`
`),i("span",{class:"line"},[i("span",null,"subjects:")]),s(`
`),i("span",{class:"line"},[i("span",null,"- kind: ServiceAccount")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins-admin")]),s(`
`),i("span",{class:"line"},[i("span",null,"  namespace: devops")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"â€œserviceAccount.yamlâ€åˆ›å»ºä¸€ä¸ªâ€œjenkins-adminâ€é›†ç¾¤è§’è‰²ï¼Œâ€œjenkins-adminâ€æœåŠ¡å¸æˆ·ï¼Œå¹¶å°†â€œclusterRoleâ€ç»‘å®šåˆ°æœåŠ¡å¸æˆ·ã€‚",-1),i("p",null,"â€œjenkins-adminâ€ç¾¤é›†è§’è‰²å…·æœ‰ç®¡ç†ç¾¤é›†ç»„ä»¶çš„æ‰€æœ‰æƒé™ã€‚ æ‚¨è¿˜å¯ä»¥é€šè¿‡æŒ‡å®šå•ä¸ªèµ„æºæ“ä½œæ¥é™åˆ¶è®¿é—®ã€‚",-1),i("p",null,"ç°åœ¨ä½¿ç”¨ kubectl åˆ›å»ºæœåŠ¡å¸æˆ·ã€‚",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"kubectl apply -f serviceAccount.yaml")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[i("strong",null,"æ­¥éª¤3ï¼š"),s(" åˆ›å»ºâ€œvolume.yamlâ€å¹¶å¤åˆ¶ä»¥ä¸‹æŒä¹…å·æ¸…å•ã€‚")],-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"kind: StorageClass")]),s(`
`),i("span",{class:"line"},[i("span",null,"apiVersion: storage.k8s.io/v1")]),s(`
`),i("span",{class:"line"},[i("span",null,"metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: local-storage")]),s(`
`),i("span",{class:"line"},[i("span",null,"provisioner: kubernetes.io/no-provisioner")]),s(`
`),i("span",{class:"line"},[i("span",null,"volumeBindingMode: WaitForFirstConsumer")]),s(`
`),i("span",{class:"line"},[i("span",null,"---")]),s(`
`),i("span",{class:"line"},[i("span",null,"apiVersion: v1")]),s(`
`),i("span",{class:"line"},[i("span",null,"kind: PersistentVolume")]),s(`
`),i("span",{class:"line"},[i("span",null,"metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins-pv-volume")]),s(`
`),i("span",{class:"line"},[i("span",null,"  labels:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    type: local")]),s(`
`),i("span",{class:"line"},[i("span",null,"spec:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  storageClassName: local-storage")]),s(`
`),i("span",{class:"line"},[i("span",null,"  claimRef:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    name: jenkins-pv-claim")]),s(`
`),i("span",{class:"line"},[i("span",null,"    namespace: devops")]),s(`
`),i("span",{class:"line"},[i("span",null,"  capacity:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    storage: 10Gi")]),s(`
`),i("span",{class:"line"},[i("span",null,"  accessModes:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    - ReadWriteOnce")]),s(`
`),i("span",{class:"line"},[i("span",null,"  local:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    path: /opt/nfs/jenkins	#ä¹‹å‰è®¾ç½®çš„nfså­˜å‚¨ç›®å½•")]),s(`
`),i("span",{class:"line"},[i("span",null,"  nodeAffinity:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    required:")]),s(`
`),i("span",{class:"line"},[i("span",null,"      nodeSelectorTerms:")]),s(`
`),i("span",{class:"line"},[i("span",null,"      - matchExpressions:")]),s(`
`),i("span",{class:"line"},[i("span",null,"        - key: kubernetes.io/hostname")]),s(`
`),i("span",{class:"line"},[i("span",null,"          operator: In")]),s(`
`),i("span",{class:"line"},[i("span",null,"          values:")]),s(`
`),i("span",{class:"line"},[i("span",null,"          - master	#MasterèŠ‚ç‚¹ä¸»æœºå")]),s(`
`),i("span",{class:"line"},[i("span",null,"---")]),s(`
`),i("span",{class:"line"},[i("span",null,"apiVersion: v1")]),s(`
`),i("span",{class:"line"},[i("span",null,"kind: PersistentVolumeClaim")]),s(`
`),i("span",{class:"line"},[i("span",null,"metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins-pv-claim")]),s(`
`),i("span",{class:"line"},[i("span",null,"  namespace: devops")]),s(`
`),i("span",{class:"line"},[i("span",null,"spec:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  storageClassName: local-storage")]),s(`
`),i("span",{class:"line"},[i("span",null,"  accessModes:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    - ReadWriteOnce")]),s(`
`),i("span",{class:"line"},[i("span",null,"  resources:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    requests:")]),s(`
`),i("span",{class:"line"},[i("span",null,"      storage: 3Gi")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"å¯¹äºå·ï¼Œæˆ‘ä»¬ä½¿ç”¨â€œæœ¬åœ°â€å­˜å‚¨ç±»è¿›è¡Œæ¼”ç¤ºã€‚ è¿™æ„å‘³ç€ï¼Œå®ƒä¼šåœ¨â€œ/opt/nfs/jenkinsâ€ä½ç½®ä¸‹çš„ç‰¹å®šèŠ‚ç‚¹ä¸­åˆ›å»ºä¸€ä¸ªâ€œPersistentVolumeâ€å·ã€‚",-1),i("p",null,"ç”±äºâ€œæœ¬åœ°â€å­˜å‚¨ç±»éœ€è¦èŠ‚ç‚¹é€‰æ‹©å™¨ï¼Œå› æ­¤æ‚¨éœ€è¦æ­£ç¡®æŒ‡å®šå·¥ä½œèŠ‚ç‚¹åç§°ï¼Œä»¥ä¾¿å°† Jenkins Pod è°ƒåº¦åˆ°ç‰¹å®šèŠ‚ç‚¹ä¸­ã€‚",-1),i("p",null,"å¦‚æœ Pod è¢«åˆ é™¤æˆ–é‡æ–°å¯åŠ¨ï¼Œæ•°æ®å°†ä¿ç•™åœ¨èŠ‚ç‚¹å·ä¸­ã€‚ ä½†æ˜¯ï¼Œå¦‚æœèŠ‚ç‚¹è¢«åˆ é™¤ï¼Œæ‚¨å°†ä¸¢å¤±æ‰€æœ‰æ•°æ®ã€‚",-1),i("p",null,"ç†æƒ³æƒ…å†µä¸‹ï¼Œåº”ä½¿ç”¨äº‘æä¾›å•†æä¾›çš„å¯ç”¨å­˜å‚¨ç±»æˆ–ç¾¤é›†ç®¡ç†å‘˜æä¾›çš„å­˜å‚¨ç±»æ¥ä½¿ç”¨æŒä¹…æ€§å·ï¼Œä»¥ä¾¿åœ¨èŠ‚ç‚¹æ•…éšœæ—¶ä¿ç•™æ•°æ®ã€‚",-1),i("p",null,"è®©æˆ‘ä»¬ä½¿ç”¨ kubectl åˆ›å»ºå·",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"kubectl create -f volume.yaml")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"**æ­¥éª¤4ï¼š**åˆ›å»ºåä¸ºâ€œdeployment.yamlâ€çš„éƒ¨ç½²æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶ä»¥ä¸‹éƒ¨ç½²æ¸…å•ã€‚",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"apiVersion: apps/v1")]),s(`
`),i("span",{class:"line"},[i("span",null,"kind: Deployment")]),s(`
`),i("span",{class:"line"},[i("span",null,"metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins")]),s(`
`),i("span",{class:"line"},[i("span",null,"  namespace: devops")]),s(`
`),i("span",{class:"line"},[i("span",null,"spec:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  replicas: 1")]),s(`
`),i("span",{class:"line"},[i("span",null,"  selector:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    matchLabels:")]),s(`
`),i("span",{class:"line"},[i("span",null,"      app: jenkins-server")]),s(`
`),i("span",{class:"line"},[i("span",null,"  template:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"      labels:")]),s(`
`),i("span",{class:"line"},[i("span",null,"        app: jenkins-server")]),s(`
`),i("span",{class:"line"},[i("span",null,"    spec:")]),s(`
`),i("span",{class:"line"},[i("span",null,"      nodeSelector:")]),s(`
`),i("span",{class:"line"},[i("span",null,'        jenkins: "master"')]),s(`
`),i("span",{class:"line"},[i("span",null,"      tolerations:")]),s(`
`),i("span",{class:"line"},[i("span",null,'      - key: "node-role.kubernetes.io/control-plane"')]),s(`
`),i("span",{class:"line"},[i("span",null,'        operator: "Exists"')]),s(`
`),i("span",{class:"line"},[i("span",null,'        effect: "NoSchedule"')]),s(`
`),i("span",{class:"line"},[i("span",null,"      securityContext:")]),s(`
`),i("span",{class:"line"},[i("span",null,"            fsGroup: 1000")]),s(`
`),i("span",{class:"line"},[i("span",null,"            runAsUser: 1000")]),s(`
`),i("span",{class:"line"},[i("span",null,"      serviceAccountName: jenkins-admin")]),s(`
`),i("span",{class:"line"},[i("span",null,"      containers:")]),s(`
`),i("span",{class:"line"},[i("span",null,"        - name: jenkins")]),s(`
`),i("span",{class:"line"},[i("span",null,"          image: docker.io/jenkins/jenkins:latest")]),s(`
`),i("span",{class:"line"},[i("span",null,"          imagePullPolicy: IfNotPresent")]),s(`
`),i("span",{class:"line"},[i("span",null,"          resources:")]),s(`
`),i("span",{class:"line"},[i("span",null,"            limits:")]),s(`
`),i("span",{class:"line"},[i("span",null,'              memory: "2Gi"')]),s(`
`),i("span",{class:"line"},[i("span",null,'              cpu: "1000m"')]),s(`
`),i("span",{class:"line"},[i("span",null,"            requests:")]),s(`
`),i("span",{class:"line"},[i("span",null,'              memory: "500Mi"')]),s(`
`),i("span",{class:"line"},[i("span",null,'              cpu: "500m"')]),s(`
`),i("span",{class:"line"},[i("span",null,"          ports:")]),s(`
`),i("span",{class:"line"},[i("span",null,"            - name: httpport")]),s(`
`),i("span",{class:"line"},[i("span",null,"              containerPort: 8080")]),s(`
`),i("span",{class:"line"},[i("span",null,"            - name: jnlpport")]),s(`
`),i("span",{class:"line"},[i("span",null,"              containerPort: 50000")]),s(`
`),i("span",{class:"line"},[i("span",null,"          livenessProbe:")]),s(`
`),i("span",{class:"line"},[i("span",null,"            httpGet:")]),s(`
`),i("span",{class:"line"},[i("span",null,'              path: "/login"')]),s(`
`),i("span",{class:"line"},[i("span",null,"              port: 8080")]),s(`
`),i("span",{class:"line"},[i("span",null,"            initialDelaySeconds: 90")]),s(`
`),i("span",{class:"line"},[i("span",null,"            periodSeconds: 10")]),s(`
`),i("span",{class:"line"},[i("span",null,"            timeoutSeconds: 5")]),s(`
`),i("span",{class:"line"},[i("span",null,"            failureThreshold: 5")]),s(`
`),i("span",{class:"line"},[i("span",null,"          readinessProbe:")]),s(`
`),i("span",{class:"line"},[i("span",null,"            httpGet:")]),s(`
`),i("span",{class:"line"},[i("span",null,'              path: "/login"')]),s(`
`),i("span",{class:"line"},[i("span",null,"              port: 8080")]),s(`
`),i("span",{class:"line"},[i("span",null,"            initialDelaySeconds: 60")]),s(`
`),i("span",{class:"line"},[i("span",null,"            periodSeconds: 10")]),s(`
`),i("span",{class:"line"},[i("span",null,"            timeoutSeconds: 5")]),s(`
`),i("span",{class:"line"},[i("span",null,"            failureThreshold: 3")]),s(`
`),i("span",{class:"line"},[i("span",null,"          volumeMounts:")]),s(`
`),i("span",{class:"line"},[i("span",null,"            - name: jenkins-data")]),s(`
`),i("span",{class:"line"},[i("span",null,"              subPath: jenkinsMaster")]),s(`
`),i("span",{class:"line"},[i("span",null,"              mountPath: /var/jenkins_home")]),s(`
`),i("span",{class:"line"},[i("span",null,"      volumes:")]),s(`
`),i("span",{class:"line"},[i("span",null,"        - name: jenkins-data")]),s(`
`),i("span",{class:"line"},[i("span",null,"          persistentVolumeClaim:")]),s(`
`),i("span",{class:"line"},[i("span",null,"              claimName: jenkins-pv-claim")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"åœ¨æ­¤ Jenkins Kubernetes éƒ¨ç½²ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä»¥ä¸‹å†…å®¹ï¼š",-1),i("ol",null,[i("li",null,"â€œsecurityContextâ€ï¼Œä»¥ä¾¿ Jenkins pod èƒ½å¤Ÿå†™å…¥æœ¬åœ°æŒä¹…å·ã€‚"),i("li",null,"ç”¨äºç›‘è§† Jenkins pod è¿è¡ŒçŠ¶å†µçš„ Liveness and readiness æ¢æµ‹ã€‚"),i("li",null,"åŸºäºä¿å­˜ Jenkins æ•°æ®è·¯å¾„â€œ/var/jenkins_homeâ€çš„æœ¬åœ°å­˜å‚¨ç±»çš„æœ¬åœ°æŒä¹…æ€§å·ã€‚")],-1),i("p",null,"ä½¿ç”¨ kubectl åˆ›å»ºéƒ¨ç½²ã€‚",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"kubectl apply -f deployment.yaml")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"æ£€æŸ¥éƒ¨ç½²çŠ¶æ€ã€‚",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"kubectl get deployments -n devops")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è·å–éƒ¨ç½²è¯¦ç»†ä¿¡æ¯ã€‚",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"kubectl describe deployments --namespace=devops")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h3",{id:"ä½¿ç”¨-kubernetes-æœåŠ¡è®¿é—®-jenkins",tabindex:"-1"},[s("ä½¿ç”¨ Kubernetes æœåŠ¡è®¿é—® Jenkins "),i("a",{class:"header-anchor",href:"#ä½¿ç”¨-kubernetes-æœåŠ¡è®¿é—®-jenkins","aria-label":'Permalink to "ä½¿ç”¨ Kubernetes æœåŠ¡è®¿é—® Jenkins"'},"â€‹")],-1),i("p",null,"ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªéƒ¨ç½²ã€‚ ä½†æ˜¯ï¼Œå®ƒä¸å¯¹å¤–ç•Œå¼€æ”¾ã€‚ ä¸ºäº†ä»å¤–éƒ¨ä¸–ç•Œè®¿é—® Jenkins éƒ¨ç½²ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæœåŠ¡å¹¶å°†å…¶æ˜ å°„åˆ°éƒ¨ç½²ã€‚",-1),i("p",null,"åˆ›å»ºâ€œservice.yamlâ€å¹¶å¤åˆ¶ä»¥ä¸‹æœåŠ¡æ¸…å•ï¼š",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"apiVersion: v1")]),s(`
`),i("span",{class:"line"},[i("span",null,"kind: Service")]),s(`
`),i("span",{class:"line"},[i("span",null,"metadata:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  name: jenkins-service")]),s(`
`),i("span",{class:"line"},[i("span",null,"  namespace: devops")]),s(`
`),i("span",{class:"line"},[i("span",null,"  annotations:")]),s(`
`),i("span",{class:"line"},[i("span",null,"      prometheus.io/scrape: 'true'")]),s(`
`),i("span",{class:"line"},[i("span",null,"      prometheus.io/path:   /")]),s(`
`),i("span",{class:"line"},[i("span",null,"      prometheus.io/port:   '8080'")]),s(`
`),i("span",{class:"line"},[i("span",null,"spec:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  selector:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    app: jenkins-server")]),s(`
`),i("span",{class:"line"},[i("span",null,"  type: NodePort")]),s(`
`),i("span",{class:"line"},[i("span",null,"  ports:")]),s(`
`),i("span",{class:"line"},[i("span",null,"  - name: httpport")]),s(`
`),i("span",{class:"line"},[i("span",null,"    port: 8080")]),s(`
`),i("span",{class:"line"},[i("span",null,"    targetPort: httpport")]),s(`
`),i("span",{class:"line"},[i("span",null,"    nodePort: 32000")]),s(`
`),i("span",{class:"line"},[i("span",null,"  - name: jnlpport")]),s(`
`),i("span",{class:"line"},[i("span",null,"    port: 50000")]),s(`
`),i("span",{class:"line"},[i("span",null,"    targetPort: jnlpport")]),s(`
`),i("span",{class:"line"},[i("span",null,"    nodePort: 32500")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"ä½¿ç”¨ kubectl åˆ›å»º Jenkins æœåŠ¡ã€‚",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"kubectl apply -f service.yaml")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"ç°åœ¨ï¼Œå½“æµè§ˆåˆ°ç«¯å£ 32000 ä¸Šçš„ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ IP æ—¶ï¼Œæ‚¨å°†èƒ½å¤Ÿè®¿é—® Jenkins ä»ªè¡¨æ¿ã€‚",-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"http://<master-ip>:32000")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[s("æŸ¥çœ‹ jenkins çš„ pod åœ¨ running çŠ¶æ€ï¼Œé€šè¿‡"),i("a",{href:"http://172.30.26.172:32000/%E8%AE%BF%E9%97%AE",target:"_blank",rel:"noreferrer"},"http://172.30.26.172:32000/è®¿é—®"),s(" jenkins")],-1),i("p",null,[s("æŸ¥çœ‹ jenkins åˆå§‹å¯†ç "),i("code",null,"cat /opt/nfs/jenkins/jenkinsMaster/secrets/initialAdminPassword")],-1),i("p",null,"åˆ›å»ºç”¨æˆ·ï¼Œç„¶åé€‰æ‹©ä¿å­˜å¹¶å®Œæˆ",-1),i("figure",null,[i("img",{src:D,alt:"",loading:"lazy",decoding:"async"})],-1),i("figure",null,[i("img",{src:C,alt:"",loading:"lazy",decoding:"async"})],-1),i("figure",null,[i("img",{src:v,alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"è®¾ç½®å…¨å±€å®‰å…¨è®¾ç½®ä¸ºä»»ä½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹",-1),i("figure",null,[i("img",{src:A,alt:"",loading:"lazy",decoding:"async"})],-1),i("h3",{id:"å®‰è£…æ’ä»¶",tabindex:"-1"},[s("å®‰è£…æ’ä»¶ "),i("a",{class:"header-anchor",href:"#å®‰è£…æ’ä»¶","aria-label":'Permalink to "å®‰è£…æ’ä»¶"'},"â€‹")],-1),i("p",null,"å‰å¾€ ç³»ç»Ÿç®¡ç†-æ’ä»¶ç®¡ç†-Available pluginsï¼Œæœç´¢Kuberneteså’ŒDockerè¿™ä¸¤ä¸ªæ’ä»¶ï¼Œéƒ½è¿›è¡Œå®‰è£…ï¼Œå¯ä»¥é€‰æ‹©æ€§å®‰è£…Blue Oceanï¼Œè¿™æ ·å¯ä»¥æ›´å¥½çš„è§‚å¯Ÿæµæ°´çº¿çš„è¿ä½œ",-1),i("h2",{id:"é…ç½®-jankinscloud",tabindex:"-1"},[s("é…ç½® JankinsCloud "),i("a",{class:"header-anchor",href:"#é…ç½®-jankinscloud","aria-label":'Permalink to "é…ç½® JankinsCloud"'},"â€‹")],-1),i("blockquote",null,[i("p",null,"âš ï¸æ³¨æ„ï¼Œæ‰€æœ‰ IP åœ°å€è¯·æ”¹ä¸ºmaster èŠ‚ç‚¹çš„ IP")],-1),i("p",null,[s("è¿›å…¥cloud èŠ‚ç‚¹é…ç½®é¡µé¢"),i("a",{href:"http://172.30.26.172:32000/manage/cloud/%EF%BC%88%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86-Clouds-New",target:"_blank",rel:"noreferrer"},"http://172.30.26.172:32000/manage/cloud/ï¼ˆç³»ç»Ÿç®¡ç†-Clouds-New"),s(" cloudï¼‰")],-1),i("p",null,"ç‚¹å‡» New Cloud",-1),i("ul",null,[i("li",null,[i("p",null,[s("Cloud Name "),i("code",null,"worker1")])]),i("li",null,[i("p",null,[s("Type "),i("code",null,"Kubernetes")])])],-1),i("p",null,"è¿›å…¥ä¸‹ä¸€æ­¥",-1),i("ul",null,[i("li",null,[i("p",null,[s("åœ¨ç»ˆç«¯è¾“å…¥"),i("code",null,"kubectl cluster-info"),s("è·å¾— ApiServer çš„åœ°å€"),i("a",{href:"https://172.30.26.172:6443",target:"_blank",rel:"noreferrer"},"https://172.30.26.172:6443")])]),i("li",null,[i("p",null,[s("Kubernetes åœ°å€"),i("code",null,"https://172.30.26.172:6443")])]),i("li",null,[i("p",null,[s("Kubernetes æœåŠ¡è¯ä¹¦ keyå¡«å†™"),i("code",null,".kube/config"),s("ä¸­"),i("code",null,"certificate-authority-data:"),s("å­—æ®µçš„å¯†é’¥")])])],-1),i("div",{class:"language-"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"LS0tLS1CRUdJTiBDRVJUSUZJ...(çœç•¥)")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("ul",null,[i("li",null,[i("p",null,[s("å‹¾é€‰"),i("code",null,"ç¦ç”¨ HTTPS è¯ä¹¦æ£€æŸ¥")])]),i("li",null,[i("p",null,[s("Kubernetes å‘½åç©ºé—´"),i("code",null,"devops")])])],-1),i("p",null,[s("ç‚¹å‡»"),i("code",null,"è¿æ¥æµ‹è¯•"),s("ï¼Œæ˜¾ç¤º"),i("code",null,"Connected to Kubernetes v1.29.0"),s("å³å¯")],-1),i("hr",null,null,-1),i("ul",null,[i("li",null,[i("p",null,[s("Jenkins åœ°å€"),i("code",null,"http://172.30.26.172:32000/")])]),i("li",null,[i("p",null,[s("Jenkins é€šé“"),i("code",null,"172.30.26.172:32500"),s("ä¸èƒ½åŠ ä»»ä½•åè®®ï¼Œå› ä¸ºæ˜¯ tcp ä¼ è¾“åè®®ï¼Œå€¼å°±æ˜¯ jenkins service çš„å¦ä¸€ä¸ªæš´éœ²çš„ç«¯å£")])])],-1),i("figure",null,[i("img",{src:j,alt:"",loading:"lazy",decoding:"async"})],-1),i("figure",null,[i("img",{src:P,alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"æœ€åç‚¹å‡»ä¸‹æ–¹ Save ä¿å­˜",-1),i("h2",{id:"é…ç½®-jankins-slave",tabindex:"-1"},[s("é…ç½® Jankins-Slave "),i("a",{class:"header-anchor",href:"#é…ç½®-jankins-slave","aria-label":'Permalink to "é…ç½® Jankins-Slave"'},"â€‹")],-1),i("p",null,[s("åœ¨ Jankins-Slave æ¶æ„ä¸­ï¼ŒSlave èŠ‚ç‚¹é€šå¸¸ç”± "),i("code",null,"jenkins/inbound-agent"),s(" é•œåƒç›´æ¥ç”Ÿæˆï¼Œåœ¨æµæ°´çº¿å®Œæˆåï¼Œæ­¤èŠ‚ç‚¹å°±ä¼šè¢«åˆ é™¤ï¼Œå› ä¸ºæœ¬é¡¹ç›®éœ€è¦æ„å»ºçš„æ˜¯ vite é¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ª Slave èŠ‚ç‚¹çš„é•œåƒï¼Œä»¥ä¾¿é¡¹ç›®çš„æ„å»º")],-1),i("h3",{id:"æ„å»ºç‰¹æ®Šçš„-agent-é•œåƒ",tabindex:"-1"},[s("æ„å»ºç‰¹æ®Šçš„ agent é•œåƒ "),i("a",{class:"header-anchor",href:"#æ„å»ºç‰¹æ®Šçš„-agent-é•œåƒ","aria-label":'Permalink to "æ„å»ºç‰¹æ®Šçš„ agent é•œåƒ"'},"â€‹")],-1),i("p",null,[s("åœ¨ root ç›®å½•åˆ›å»º"),i("code",null,"inbound-agent-node"),s("ç›®å½•ï¼Œåœ¨æ­¤ç›®å½•å®Œæˆé•œåƒæ„å»º "),i("code",null,"cd inbound-agent-node")],-1),i("p",null,[s("ä¸‹è½½ nodejs ç¨‹åº "),i("code",null,"wget https://nodejs.org/dist/v20.13.1/node-v20.13.1-linux-x64.tar.xz")],-1),i("p",null,"ç¼–è¾‘ Dockerfile",-1),i("p",null,[i("code",null,"vim inbound-agent-node-Dockerfile")],-1),i("div",{class:"language-dockerfile"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"dockerfile"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," jenkins/inbound-agent")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"USER"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," root")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"WORKDIR"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," /usr/local")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ADD"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," node-v20.13.1-linux-x64.tar.xz .")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENV"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PATH="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/usr/local/node-v20.13.1-linux-x64/bin:${PATH}"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RUN"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," npm config set registry https://registry.npmmirror.com")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RUN"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," npm install -g pnpm")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENTRYPOINT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ["),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"jenkins-agent"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[s("æ„å»ºé•œåƒï¼Œé•œåƒçš„ tag å‰é¢çš„"),i("strong",null,"åœ°å€"),s("éœ€è¦æ”¹æˆè‡ªå·±çš„ "),i("strong",null,"Harbor ä»“åº“åœ°å€")],-1),i("p",null,[i("code",null,"docker build -t 172.30.26.172/library/inbound-agent-node:latest . -f inbound-agent-node-Dockerfile")],-1),i("p",null,[s("æ¨é€åˆ° Harbor "),i("code",null,"docker push 172.30.26.172/library/inbound-agent-node:latest")],-1),i("p",null,[s("åœ¨ "),i("code",null,"worker1"),s(" èŠ‚ç‚¹æ‹‰å–è¿™ä¸ªé•œåƒ "),i("code",null,"ctr -n k8s.io image pull --plain-http 172.30.26.172/library/inbound-agent-node:latest")],-1),i("h3",{id:"è®¾ç½®-pod-template",tabindex:"-1"},[s("è®¾ç½® Pod Template "),i("a",{class:"header-anchor",href:"#è®¾ç½®-pod-template","aria-label":'Permalink to "è®¾ç½® Pod Template"'},"â€‹")],-1),i("p",null,"Pod Template å°±æ˜¯ slave èŠ‚ç‚¹å°†ä¼šå¯åŠ¨çš„Podï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å¤šä¸ªPod Template æ¥é€‚é…å¤šä¸ªæµæ°´çº¿çš„è¿ä½œï¼Œè¿™é‡Œæˆ‘ä»¬åªæ–°å»ºä¸€ä¸ª Pod Template",-1),i("p",null,"è¿›å…¥ ç³»ç»Ÿç®¡ç†-Clouds-worker1-Pod Templatesï¼Œç‚¹å‡»å³ä¸Šè§’çš„ Add a pod template è¿›å…¥Pod template settings é¡µé¢ï¼Œæ¥ä¸‹æ¥è®¾ç½® Pod Templateã€‚",-1),i("ul",null,[i("li",null,[i("p",null,[s("åç§° "),i("code",null,"jenkins-slave")])]),i("li",null,[i("p",null,[s("å‘½åç©ºé—´ "),i("code",null,"devops")])]),i("li",null,[i("p",null,[s("æ ‡ç­¾åˆ—è¡¨ "),i("code",null,"jenkins-slave-k8s")])])],-1),i("figure",null,[i("img",{src:_,alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,[s("å·è®¾ç½®ï¼Œç‚¹å‡»"),i("code",null,"æ·»åŠ å·"),s("ï¼Œé€‰æ‹© "),i("code",null,"Host Path Volume"),s("ï¼Œæ¥ä¸‹æ¥éœ€è¦å¡«å…¥å¤šä¸ªä»ä¸»æœºæ˜ å°„åˆ° Pod ä¸­çš„æ–‡ä»¶")],-1),i("table",null,[i("thead",null,[i("tr",null,[i("th",null,"Host Path Volume"),i("th",null,"ä¸»æœºè·¯å¾„"),i("th",null,"æŒ‚è½½è·¯å¾„")])]),i("tbody",null,[i("tr",null,[i("td",null,"docker å‘½ä»¤"),i("td",null,"/usr/bin/docker"),i("td",null,"/usr/bin/docker")]),i("tr",null,[i("td",null,"docker å¥—æ¥å­—"),i("td",null,"/var/run/docker.sock"),i("td",null,"/var/run/docker.sock")]),i("tr",null,[i("td",null,"kubectl é…ç½®æ–‡ä»¶"),i("td",null,"/root/.kube"),i("td",null,"/root/.kube")]),i("tr",null,[i("td",null,"kubectl å‘½ä»¤"),i("td",null,"/usr/bin/kubectl"),i("td",null,"/usr/bin/kubectl")]),i("tr",null,[i("td",null,"ctr å‘½ä»¤"),i("td",null,"/usr/bin/ctr"),i("td",null,"/usr/bin/ctr")]),i("tr",null,[i("td",null,"containerd å¥—æ¥å­—"),i("td",null,"/run/containerd/containerd.sock"),i("td",null,"/run/containerd/containerd.sock")])])],-1),i("figure",null,[i("img",{src:S,alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,[s("ç„¶åç¿»åŠ¨é¡µé¢åˆ°ä¸‹æ–¹ï¼Œæ‰¾åˆ°"),i("code",null,"Run As User ID"),s("å’Œ"),i("code",null,"Run As Group ID"),s("ï¼Œå¡«å…¥"),i("code",null,"0"),s("ï¼Œç›®çš„æ˜¯è®© Pod ä¸­çš„å®¹å™¨å¯ä»¥æ­£å¸¸æ‰§è¡Œ docker å’Œ ctr å‘½ä»¤ã€‚ï¼ˆ0 æ˜¯å®¿ä¸»æœº root ç”¨æˆ·çš„ç»„ IDï¼‰")],-1),i("h4",{id:"è®¾ç½®å®¹å™¨",tabindex:"-1"},[s("è®¾ç½®å®¹å™¨ "),i("a",{class:"header-anchor",href:"#è®¾ç½®å®¹å™¨","aria-label":'Permalink to "è®¾ç½®å®¹å™¨"'},"â€‹")],-1),i("blockquote",null,[i("p",null,"æœ€æ–° Jenkins é»˜è®¤å¦‚æœ pod åç§°ä¸è®¾ç½®ä¸º jnlp çš„è¯ï¼Œä¼šè‡ªåŠ¨å¯åŠ¨ä¸€ä¸ª inbound-agent é•œåƒæ¥")],-1),i("p",null,[s("åœ¨åˆšæ‰çš„ Pod template settings ä¸­æ‰¾åˆ°"),i("code",null,"å®¹å™¨åˆ—è¡¨"),s("é€‰é¡¹ï¼Œç‚¹å‡»"),i("code",null,"æ·»åŠ å®¹å™¨"),s("é€‰æ‹© "),i("code",null,"Container Template")],-1),i("ul",null,[i("li",null,[s("åç§° "),i("code",null,"nodejs")]),i("li",null,[s("Docker é•œåƒ "),i("code",null,"172.30.26.172/library/inbound-agent-node:latest")]),i("li",null,[s("è¿è¡Œçš„å‘½ä»¤ "),i("code",null,"sleep")]),i("li",null,[s("å‘½ä»¤å‚æ•° "),i("code",null,"9999999")]),i("li",null,[s("å‹¾é€‰ "),i("code",null,"åˆ†é…ä¼ªç»ˆç«¯")])],-1),i("p",null,"ç‚¹å‡»ä¸‹æ–¹ Save å®Œæˆ Pod Template çš„è®¾ç½®",-1),i("h2",{id:"é…ç½®å¹¶è¿è¡Œæµæ°´çº¿",tabindex:"-1"},[s("é…ç½®å¹¶è¿è¡Œæµæ°´çº¿ "),i("a",{class:"header-anchor",href:"#é…ç½®å¹¶è¿è¡Œæµæ°´çº¿","aria-label":'Permalink to "é…ç½®å¹¶è¿è¡Œæµæ°´çº¿"'},"â€‹")],-1),i("p",null,"æ–°å»ºæµæ°´çº¿ï¼Œå‘½å ValaxyBlog",-1),i("p",null,[s("ç‚¹å‡»é…ç½®ï¼Œåœ¨é«˜çº§é¡¹ç›®é€‰é¡¹ä¸­é…ç½®æµæ°´çº¿è„šæœ¬ï¼Œå…¶ä¸­"),i("code",null,"environment"),s("æ˜¯ç¯å¢ƒå˜é‡çš„é…ç½®ï¼Œè¯·å°†"),i("code",null,"DOCKER_REGISTRY"),s("æ”¹ä¸º Harbor ä»“åº“åœ°å€ï¼Œ"),i("code",null,"Checkout Code"),s("æ­¥éª¤ä¸­çš„"),i("code",null,"git url"),s("åé¢çš„ä»“åº“åœ°å€è¯·æ”¹ä¸ºè‡ªå·±çš„ Gitea é¡¹ç›®çš„ http åœ°å€ï¼Œ")],-1),i("div",{class:"language-json"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"pipeline {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"  agent"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"    label"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'jenkins-slave-k8s'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  environment {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        DOCKER_REGISTRY"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "172.30.26.172"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        IMAGE_NAME"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "library/valaxy"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        IMAGE_TAG"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "dev"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        DOCKER_USERNAME"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'admin'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        DOCKER_PASSWORD"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'Harbor12345'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        DEPLOY_PORT"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," '30080'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    stages {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        stage('Checkout"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," Code')"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            steps"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                git"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," url"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"'http:"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//172.30.26.173:3000/root/valaxy.git', branch: 'main'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        stage('Build Application') {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            steps"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                container"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ('nodejs')"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                    script"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                        sh"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'pnpm"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," i'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                        sh"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'npm"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," run"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," build'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        stage('Build Docker Image') {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            steps"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                script"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                    sh"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "docker build -t ${DOCKER_REGISTRY}/${IMAGE_NAME}:${IMAGE_TAG} ."')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        stage('Push Docker Image') {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            steps"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                echo"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "Docker image will pushed to ${DOCKER_REGISTRY}/${IMAGE_NAME}:${IMAGE_TAG}"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                sh"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "echo ${DOCKER_PASSWORD} | docker login ${DOCKER_REGISTRY} -u ${DOCKER_USERNAME} --password-stdin"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                sh"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "docker push ${DOCKER_REGISTRY}/${IMAGE_NAME}:${IMAGE_TAG}"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                sh"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'docker"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," rmi"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ${DOCKER_REGISTRY"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/${"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"IMAGE_NAME"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}:${"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"IMAGE_TAG"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"} || "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        stage('Deploy to Kubernetes') {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            steps"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                script"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                    sh"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," '''")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                    kubectl"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," create"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," deployment"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," valaxy"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," --image=${DOCKER_REGISTRY"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/${"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"IMAGE_NAME"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}:${"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"IMAGE_TAG"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"} --dry-run=client -o yaml >> valaxy-manifests.yaml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    echo "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"---"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," >> valaxy-manifests.yaml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    kubectl create service nodeport valaxy --tcp="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"80"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"80"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," --node-port=${"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"DEPLOY_PORT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"} --dry-run=client -o yaml >> valaxy-manifests.yaml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    '''")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    sh "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"""')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                    sed -i '22a "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"        imagePullPolicy: IfNotPresent' valaxy-manifests.yaml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'                    """')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    sh '''")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ctr -n k"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"s.io image pull --plain-http ${"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"DOCKER_REGISTRY"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/${"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"IMAGE_NAME"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}:${"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"IMAGE_TAG"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    '''")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    sh '''")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    kubectl delete -f valaxy-manifests.yaml || "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    kubectl apply -f valaxy-manifests.yaml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    '''")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("figure",null,[i("img",{src:x,alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"ç‚¹å‡»å·¦ä¾§çš„ç«‹å³æ„å»ºï¼Œæµæ°´çº¿å°±å¼€å§‹è¿è¡Œäº†",-1),i("p",null,"å¯ä»¥è¿›å…¥æ„å»ºçš„ Console Output ä¸­çœ‹åˆ°æ„å»ºçš„è¯¦ç»†æƒ…å†µ",-1),i("p",null,"ä¹Ÿå¯ä»¥è¿›å…¥ BlueOcean æ›´ç›´è§‚çš„çœ‹åˆ°æ„å»ºç»†èŠ‚",-1),i("p",null,[s("åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®¿ä¸»æœºä¸Šé€šè¿‡"),i("code",null,"kubectl -n devops get po"),s("æŒ‡ä»¤æŸ¥çœ‹ä¸´æ—¶ç”Ÿæˆçš„ jenkins-slave podï¼Œå®ƒæ­£åœ¨è¿è¡Œ jenkins-master ä¸‹å‘çš„æµæ°´çº¿")],-1),i("figure",null,[i("img",{src:R,alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"æ„å»ºå®Œæˆåï¼Œè®¿é—® http://172.30.26.172:30080å°±å¯ä»¥çœ‹åˆ°åšå®¢æ­£å¸¸è¢«æµ‹è¯•å‘å¸ƒäº†ï¼Œä¸´æ—¶çš„ jenkins-slave pod ä¹Ÿè¢«è‡ªåŠ¨åˆ é™¤äº†",-1),i("figure",null,[i("img",{src:I,alt:"",loading:"lazy",decoding:"async"})],-1),i("p",null,"ğŸ‰çœ‹åˆ°æ­¤é¡µé¢å°±ä»£è¡¨æˆ‘ä»¬å·²ç»é€šè¿‡ agent èŠ‚ç‚¹çš„åŠŸèƒ½å®Œæˆäº† CICDï¼",-1),i("h1",{id:"the-end",tabindex:"-1"},[s("The End "),i("a",{class:"header-anchor",href:"#the-end","aria-label":'Permalink to "The End"'},"â€‹")],-1),i("p",null,[s("æ­å–œä½ å®Œæˆäº†æœ¬æ¬¡ç»ƒä¹ ï¼ç›¸ä¿¡ä½ ä¸€å®šå¯¹ Jenkins çš„ä½¿ç”¨æœ‰äº†æ›´æ·±çš„ç†è§£ï¼Œå½“ç„¶ä¸Šæ–‡è¿˜æ˜¯å€¾å‘äºå®æ“æ­¥éª¤ï¼Œæˆ‘æ²¡æœ‰è¯¦ç»†è¯´æ˜ä¸€äº›é…ç½®é¡¹ç›®çš„ä½œç”¨ï¼Œä»¥åŠæµæ°´çº¿çš„å„ç§ç»†èŠ‚åŠŸèƒ½ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä¹Ÿæ²¡æœ‰å®Œå…¨ç†è§£ jenkins çš„ pipeline çš„ç¼–å†™ï¼Œå¦‚æœä½ è¿˜æƒ³ç»§ç»­æ·±ç©¶ï¼Œè¯·å‰å¾€ "),i("a",{href:"https://www.jenkins.io/zh/doc/",target:"_blank",rel:"noreferrer"},"Jenkins ç”¨æˆ·æ‰‹å†Œ"),s("è¿›è¡ŒæŸ¥é˜…ï¼Œä¸€å®šä¼šæœ‰å¾ˆå¤šçš„æ”¶è´§ï¼")],-1),i("p",null,"ä¸‹é¢æ˜¯æˆ‘åœ¨æ’°å†™è¿™è¾¹æ–‡ç« çš„æ—¶å€™è®°å½•çš„æµ‹è¯•æ­¥éª¤ï¼Œå…¶ä¸­åŒ…å«äº†è®¾ç½®å¤šä¸ª Container Pod çš„ç›¸å…³çŸ¥è¯†ï¼Œå¦‚æœä½ æ„Ÿå…´è¶£å¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ï¼",-1),i("p",null,"é‚£ä¹ˆæœ¬æ–‡ç†è®ºä¸Šå°±åˆ°æ­¤ä¸ºæ­¢äº†ï¼Œsee uï½",-1),i("h2",{id:"åŠŸèƒ½æµ‹è¯•",tabindex:"-1"},[s("åŠŸèƒ½æµ‹è¯• "),i("a",{class:"header-anchor",href:"#åŠŸèƒ½æµ‹è¯•","aria-label":'Permalink to "åŠŸèƒ½æµ‹è¯•"'},"â€‹")],-1),i("h3",{id:"è®¾ç½®-pod-template-1",tabindex:"-1"},[s("è®¾ç½® Pod template "),i("a",{class:"header-anchor",href:"#è®¾ç½®-pod-template-1","aria-label":'Permalink to "è®¾ç½® Pod template"'},"â€‹")],-1),i("p",null,[s("è¿›å…¥ worker1 è¿™ä¸ª cloud çš„é…ç½®é¡µé¢"),i("a",{href:"http://172.30.26.172:32000/manage/cloud/worker1/",target:"_blank",rel:"noreferrer"},"http://172.30.26.172:32000/manage/cloud/worker1/")],-1),i("p",null,[s("ç‚¹å‡» "),i("code",null,"Pod templates"),s("-"),i("code",null,"Add a pod template")],-1),i("p",null,[s("åç§°"),i("code",null,"jenkins-slave")],-1),i("p",null,[s("å‘½åç©ºé—´"),i("code",null,"devops")],-1),i("p",null,[s("æ ‡ç­¾åˆ—è¡¨"),i("code",null,"jenkins-slave-k8s")],-1),i("h4",{id:"å®¹å™¨åˆ—è¡¨",tabindex:"-1"},[s("å®¹å™¨åˆ—è¡¨ "),i("a",{class:"header-anchor",href:"#å®¹å™¨åˆ—è¡¨","aria-label":'Permalink to "å®¹å™¨åˆ—è¡¨"'},"â€‹")],-1),i("p",null,[s("ç‚¹å‡»"),i("code",null,"æ·»åŠ å®¹å™¨"),s("-"),i("code",null,"Container Template")],-1),i("p",null,[s("åç§°"),i("code",null,"jnlp")],-1),i("p",null,[s("Docker é•œåƒ"),i("code",null,"docker.io/jenkins/inbound-agent:latest")],-1),i("p",null,[s("è¿è¡Œçš„å‘½ä»¤"),i("code",null,"jenkins-agent")],-1),i("p",null,[s("å‘½ä»¤å‚æ•°åˆ é™¤è‡ªå¸¦çš„ "),i("code",null,"9999999")],-1),i("p",null,[s("â˜‘ï¸"),i("code",null,"åˆ†é…ä¼ªç»ˆç«¯")],-1),i("p",null,[s("ç‚¹å‡»æœ€ä¸‹æ–¹ Create å®Œæˆ pod template çš„åˆ›å»º "),i("img",{src:T,alt:""})],-1),i("h3",{id:"æµ‹è¯•jenkins-slave",tabindex:"-1"},[s("æµ‹è¯•jenkins-slave "),i("a",{class:"header-anchor",href:"#æµ‹è¯•jenkins-slave","aria-label":'Permalink to "æµ‹è¯•jenkins-slave"'},"â€‹")],-1),i("p",null,[s("æ–°å»ºä¸€ä¸ªåä¸º "),i("code",null,"jnlp-test"),s("çš„æµæ°´çº¿")],-1),i("p",null,"å¡«å†™æµæ°´çº¿è„šæœ¬",-1),i("div",{class:"language-json"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"pipeline {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"  agent"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"    label"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'jenkins-slave-k8s'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  stages {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"    stage('test')"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        steps"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            script"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"                println"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "Thie pipeline is run in jenkins-slave."')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[s("ä¿å­˜ï¼Œè¿è¡Œæµæ°´çº¿ï¼Œç‚¹å‡»"),i("code",null,"ç«‹å³æ„å»º")],-1),i("p",null,[s("æŸ¥çœ‹"),i("code",null,"Console Output")],-1),i("div",{class:"language-json"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Started by user jenkins")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] Start of Pipeline")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] node")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Agent jenkins-slave-fxpzg is provisioned from template jenkins-slave")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"---")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"apiVersion: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"v1"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"......çœç•¥")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    name: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"workspace-volume"')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Running on jenkins-slave-fxpzg in /home/jenkins/agent/workspace/jnlp-test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"[Pipeline]"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," stage")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"[Pipeline]"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," (test)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"[Pipeline]"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," script")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"[Pipeline]"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"[Pipeline]"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," echo")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Thie"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," pipeline"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," is"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," run"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," in"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," jenkins-slave.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"[Pipeline]"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// script")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// stage")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// node")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"Pipeline"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"] End of Pipeline")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Finished: SUCCESS")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[s("å‡ºç°"),i("code",null,"Thie pipeline is run in jenkins-slave."),s("å°±ä»£è¡¨ä½¿ç”¨ jenkins-slave æ„å»ºæˆåŠŸäº†ï¼")],-1),i("p",null,[s("åœ¨æ„å»ºçš„è¿‡ç¨‹ä¸­é€šè¿‡"),i("code",null,"kubectl -n devops get po"),s("å¯ä»¥æŸ¥çœ‹åˆ°æœ‰ä¸€ä¸ªåä¸º"),i("code",null,"jenkins-slave-5jjcw"),s("çš„ pod åœ¨ running çŠ¶æ€ï¼Œå½“æµæ°´çº¿è¿è¡Œå®Œæˆåï¼Œè¿™ä¸ª pod åˆä¼šé©¬ä¸Šæ¶ˆå¤±ï¼Œè¿™ä»£è¡¨æˆ‘ä»¬ç¡®å®å®Œæˆäº†åŠ¨æ€çš„ jenkins-slave çš„åŠŸèƒ½å®ç°ã€‚")],-1),i("h3",{id:"è®¾ç½®å¤šä¸ª-pod-template",tabindex:"-1"},[s("è®¾ç½®å¤šä¸ª Pod Template "),i("a",{class:"header-anchor",href:"#è®¾ç½®å¤šä¸ª-pod-template","aria-label":'Permalink to "è®¾ç½®å¤šä¸ª Pod Template"'},"â€‹")],-1),i("p",null,"è¿›å…¥ clouds>worker1>jenkins-slave é¡µé¢",-1),i("p",null,[s("ç‚¹å‡»"),i("code",null,"æ·»åŠ å®¹å™¨"),s("-"),i("code",null,"Container Template")],-1),i("p",null,[s("åç§°"),i("code",null,"nodejs")],-1),i("p",null,[s("Docker é•œåƒ"),i("code",null,"172.30.26.172/library/inbound-agent-node:latest")],-1),i("p",null,[s("è¿è¡Œçš„å‘½ä»¤"),i("code",null,"sleep")],-1),i("p",null,[s("å‘½ä»¤å‚æ•°ä¿æŒ "),i("code",null,"9999999")],-1),i("h4",{id:"è‡ªå®šä¹‰ä¸€ä¸ª-agent-é•œåƒ",tabindex:"-1"},[s("è‡ªå®šä¹‰ä¸€ä¸ª agent é•œåƒ "),i("a",{class:"header-anchor",href:"#è‡ªå®šä¹‰ä¸€ä¸ª-agent-é•œåƒ","aria-label":'Permalink to "è‡ªå®šä¹‰ä¸€ä¸ª agent é•œåƒ"'},"â€‹")],-1),i("blockquote",null,[i("p",null,"å› ä¸ºé¡¹ç›®æ˜¯åŸºäº vite çš„é¡¹ç›®ï¼Œæ‰€ä»¥æ„å»ºéœ€è¦ node ç¯å¢ƒ")],-1),i("p",null,"åˆ›å»ºinbound-agent-nodeç›®å½•ï¼Œåœ¨æ­¤ç›®å½•å®Œæˆé•œåƒæ„å»º",-1),i("p",null,[s("ä¸‹è½½ nodejs ç¨‹åº "),i("code",null,"wget https://nodejs.org/dist/v20.13.1/node-v20.13.1-linux-x64.tar.xz")],-1),i("p",null,"ç¼–è¾‘ Dockerfile",-1),i("p",null,[i("code",null,"vim inbound-agent-node-Dockerfile")],-1),i("div",{class:"language-dockerfile"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"dockerfile"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," jenkins/inbound-agent")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"USER"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," root")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"WORKDIR"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," /usr/local")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ADD"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," node-v20.13.1-linux-x64.tar.xz .")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENV"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PATH="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/usr/local/node-v20.13.1-linux-x64/bin:${PATH}"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RUN"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," npm config set registry https://registry.npmmirror.com")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RUN"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," npm install -g pnpm")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENTRYPOINT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ["),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"jenkins-agent"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[s("æ„å»ºé•œåƒ "),i("code",null,"docker build -t 172.30.26.172/library/inbound-agent-node:latest . -f inbound-agent-node-Dockerfile")],-1),i("p",null,[s("æ¨é€åˆ° Harbor "),i("code",null,"docker push 172.30.26.172/library/inbound-agent-node:latest")],-1),i("h4",{id:"ç¼–å†™æµæ°´çº¿",tabindex:"-1"},[s("ç¼–å†™æµæ°´çº¿ "),i("a",{class:"header-anchor",href:"#ç¼–å†™æµæ°´çº¿","aria-label":'Permalink to "ç¼–å†™æµæ°´çº¿"'},"â€‹")],-1),i("blockquote",null,[i("p",null,[s("æ ¹æ®æœ€æ–°çš„ kubernetes æ’ä»¶çš„è§„åˆ™è¿›è¡Œç¼–å†™ï¼Œå®˜æ–¹é¡µé¢å†™äº†ä¸¤ç§æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œä¸ç”¨æ‰‹åŠ¨å†™ Pod Templateâ€”â€”"),i("a",{href:"https://plugins.jenkins.io/kubernetes/",target:"_blank",rel:"noreferrer"},"Kubernetes çš„ |Jenkins æ’ä»¶")])],-1),i("div",{class:"language-json"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"pipeline {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"  agent"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"    label"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'jenkins-slave-k8s'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  stages {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"    stage('test')"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"      steps"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"        container"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ('jnlp')"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"          script"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            println"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "This pipeline is run in jnlp pod."')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            sh"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'node"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," -v"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," ||"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," true'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        container ('nodejs') {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"          script"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            println"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},' "This pipeline is run in node pod."')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            sh"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'node"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," -v'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            sh"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'npm"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," -v'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"            sh"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," 'pnpm"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}}," -v'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,[s("è¿è¡Œæµæ°´çº¿ï¼Œåœ¨ Console Output ä¸­å¯ä»¥çœ‹åˆ°è‡ªåŠ¨ç”Ÿæˆçš„ yaml æ–‡ä»¶ä¸­æœ‰äº†ä¸¤ä¸ª Containersï¼Œè¯æ˜äº†"),i("code",null,"test stage"),s("ä¸­çš„ç¬¬å”¯ä¸€ä¸€ä¸ª"),i("code",null,"steps"),s("ä¸­ç¡®å®å¯åŠ¨äº†ä¸¤ä¸ªå®¹å™¨ï¼Œé€šè¿‡ kubectl å‘½ä»¤å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª pod åœ¨è¿è¡Œï¼Œè¯´é¢å¤š pod template æ¨¡å¼åŠŸèƒ½æµ‹è¯•æˆåŠŸã€‚")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Started"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," by"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," user"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," jenkins")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Pipeline] Start of Pipeline")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Pipeline] node")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Agent"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," jenkins-slave-1g78h"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," is"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," provisioned"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," from"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," template"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," jenkins-slave")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"---")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"apiVersion:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "v1"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"....."),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".yaml"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," çœç•¥")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Running"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," jenkins-slave-1g78h"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," in"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /home/jenkins/agent/workspace/jnlp-test")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},".."),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".çœç•¥")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Pipeline] echo")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"This"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pipeline"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," is"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," in"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," jnlp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pod.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Pipeline] sh")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"/home/jenkins/agent/workspace/jnlp-test@tmp/durable-8ed80d21/script.sh.copy:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 1:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," not"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," found")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"+"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},".."),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".çœç•¥")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Pipeline] echo")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"This"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pipeline"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," is"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," in"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pod.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Pipeline] sh")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"v20.13.1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Pipeline] sh")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," npm"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"10.5.2")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Pipeline] sh")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pnpm"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"9.1.2")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},".."),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".çœç•¥")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@master "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# kubectl -n devops get po")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"NAME"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                       READY"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"   STATUS"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"    RESTARTS"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"      AGE")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"jenkins-79f4445887-lncxs"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"   1/1"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     Running"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"   2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (45h "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ago"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")   46h")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"jenkins-slave-2zwxb"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"        2/2"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     Running"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"   0"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"             41s")])])]),i("button",{class:"code-block-unfold-btn"})],-1)])]),"main-header":l(()=>[a(n.$slots,"main-header")]),"main-header-after":l(()=>[a(n.$slots,"main-header-after")]),"main-nav":l(()=>[a(n.$slots,"main-nav")]),"main-content-before":l(()=>[a(n.$slots,"main-content-before")]),"main-content":l(()=>[a(n.$slots,"main-content")]),"main-content-after":l(()=>[a(n.$slots,"main-content-after")]),"main-nav-before":l(()=>[a(n.$slots,"main-nav-before")]),"main-nav-after":l(()=>[a(n.$slots,"main-nav-after")]),comment:l(()=>[a(n.$slots,"comment")]),footer:l(()=>[a(n.$slots,"footer")]),aside:l(()=>[a(n.$slots,"aside")]),"aside-custom":l(()=>[a(n.$slots,"aside-custom")]),default:l(()=>[a(n.$slots,"default")]),_:3},8,["frontmatter"])}}};export{Q as default,G as usePageData};
