import{_ as k}from"./ValaxyMain.vue_vue_type_style_index_0_lang.BKY0BFev.js";import"./chunks/@vueuse/motion.C1YF0VrX.js";import{d as u,u as c,a as g}from"./chunks/vue-router.B0lpXBWQ.js";import{X as y,b3 as f,b_ as i,be as n,_ as s,Y as E,a5 as t,bB as v,b5 as F}from"./framework.tSB2Odh-.js";import"./app.CfWrNu88.js";import"./chunks/dayjs.BmWuu2Zz.js";import"./chunks/vue-i18n.CP2UHYEb.js";import"./chunks/pinia.BF0-M7Fk.js";import"./chunks/nprogress.YXB5kar1.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.DoC94HOc.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.CBF25nPr.js";import"./post.TKccRjPH.js";const b=u("/posts/Frpc-systemd-restart",async l=>JSON.parse('{"title":"为Systemd服务设置自动重启","description":"","frontmatter":{"layout":"post","title":"为Systemd服务设置自动重启","date":"2024-01-21 18:08:10","tags":["Linux"],"categories":["Linux"],"cover":null,"hide":null,"password":null},"headers":[],"relativePath":"pages/posts/Frpc-systemd-restart.md","lastUpdated":1767692976000}'),{lazy:(l,r)=>l.name===r.name}),O={__name:"Frpc-systemd-restart",setup(l,{expose:r}){const{data:p}=b(),d=c(),m=g(),o=Object.assign(m.meta.frontmatter||{},p.value?.frontmatter||{});return d.currentRoute.value.data=p.value,F("valaxy:frontmatter",o),globalThis.$frontmatter=o,r({frontmatter:{layout:"post",title:"为Systemd服务设置自动重启",date:"2024-01-21 18:08:10",tags:["Linux"],categories:["Linux"],cover:null,hide:null,password:null}}),(e,a)=>{const h=k;return f(),y(h,{frontmatter:v(o)},{"main-content-md":i(()=>[a[0]||(a[0]=s("h2",{id:"事情起因",tabindex:"-1"},[t("事情起因 "),s("a",{class:"header-anchor",href:"#事情起因","aria-label":'Permalink to "事情起因"'},"​")],-1)),a[1]||(a[1]=s("p",null,"最近给自己的双路E5搞一个Frpc，但是因为有Clash这个开机自启程序，并且我设置了系统代理，在Clash完全启动之前系统是处于断网状态的。断网状态下，Frpc会默认启动失败并且变为Inactive状态，这并不是我想看到的。",-1)),E(" more "),a[2]||(a[2]=s("p",null,"于是我上网查询了一下，于是乎找到了以下三个Systemd-[Service]参数",-1)),a[3]||(a[3]=s("div",{class:"language-ini"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"ini"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"[Unit]")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Description"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=frpc service")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"After"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=network.target syslog.target")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Wants"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=network.target")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"[Service]")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Type"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=simple")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ExecStart"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=/Apps/frp_0.52.3_linux_amd64/frpc -c /Apps/frp_0.52.3_linux_amd64/frpc.toml")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Restart"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=always // [!code ++]")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RestartSec"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=5 // [!code ++]")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"StartLimitInterval"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=0 // [!code ++]")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"[Install]")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"WantedBy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=multi-user.target")])])]),s("button",{class:"code-block-unfold-btn"})],-1)),a[4]||(a[4]=s("p",null,"三个参数的作用分别是：",-1)),a[5]||(a[5]=s("ol",null,[s("li",null,[s("strong",null,"Restart=always："),t(" 指定服务在退出时总是重新启动。")]),s("li",null,[s("strong",null,"RestartSec=5："),t(" 如果服务启动失败，指定在尝试重新启动之前等待的时间间隔，这里是 5 秒。")]),s("li",null,[s("strong",null,"StartLimitInterval=0："),t(" 指定尝试启动服务的最小时间间隔。在这里设置为 0 表示没有最小间隔，可以立即尝试重新启动服务。")])],-1)),a[6]||(a[6]=s("p",null,[t("随后只要执行"),s("code",null,"systemctl daemon-reload"),t("就可以放心重启机器，让Frpc自由启动了！")],-1))]),"main-header":i(()=>[n(e.$slots,"main-header")]),"main-header-after":i(()=>[n(e.$slots,"main-header-after")]),"main-nav":i(()=>[n(e.$slots,"main-nav")]),"main-content-before":i(()=>[n(e.$slots,"main-content-before")]),"main-content":i(()=>[n(e.$slots,"main-content")]),"main-content-after":i(()=>[n(e.$slots,"main-content-after")]),"main-nav-before":i(()=>[n(e.$slots,"main-nav-before")]),"main-nav-after":i(()=>[n(e.$slots,"main-nav-after")]),comment:i(()=>[n(e.$slots,"comment")]),footer:i(()=>[n(e.$slots,"footer")]),aside:i(()=>[n(e.$slots,"aside")]),"aside-custom":i(()=>[n(e.$slots,"aside-custom")]),default:i(()=>[n(e.$slots,"default")]),_:3},8,["frontmatter"])}}};export{O as default,b as usePageData};
